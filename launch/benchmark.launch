<?xml version="1.0"?>

<launch>
  <arg name="file_in"   default="benchmark"/>
  <arg name="max_matches"            default="200"/>
  <arg name="test_robustness"        default="false"/>
  <arg name="double_ba"              default="false"/>
  <arg name="bundle_adjustment_tol"  default="0.05"/>
  <arg name="rpt2"                   default="6" />
  <arg name="rpt3"                   default="10" />
  <arg name="file_out"  default="result_robust_$(arg test_robustness)_mm_$(arg max_matches)_batol_$(arg bundle_adjustment_tol)_rpt2_$(arg rpt2)_rpt3_$(arg rpt3)"/>

  <include file="$(find boris_drone)/launch/global_params.xml" />
  <include file="$(find boris_drone)/launch/gui.xml" />
  <include file="$(find boris_drone)/launch/slam.xml" >
    <arg name="max_matches"            value="$(arg max_matches)"/>
    <arg name="test_robustness"        value="$(arg test_robustness)"/>
    <arg name="double_ba"              value="$(arg double_ba)"/>
    <arg name="bundle_adjustment_tol"  value="$(arg bundle_adjustment_tol)"/>
    <arg name="rpt2"                   value="$(arg rpt2)"/>
    <arg name="rpt3"                   value="$(arg rpt3)"/>
    <arg name="only_init"              value="true" />
  </include>

  <node name="boris_drone_manual_pose_estimation" pkg="boris_drone" type="manual_pose_estimation" output="screen"></node>
  <node pkg="rosbag" type="play"   name="player"   output="screen" args="-q /home/$(env USER)/bagfiles/$(arg file_in).bag"/>
  <node pkg="rosbag" type="record" name="recorder" output="screen" args="-O /home/$(env USER)/bagfiles/$(arg file_out).bag /pose_visual /pose_estimation /benchmark"/>
</launch>
